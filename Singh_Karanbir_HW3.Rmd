---
title: 'Stat. 316: Homework 3'
author: "Singh Karanbir"
date: "9/17/2021"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Homework 3



### Exercise 2.12

a. Simulate rolling two dice and adding their values. Perform 10000 simulations and make a bar chart showing how many of each outcome occurred.

```{r}
die1 <- sample(x = 1:6, size = 10000, replace = TRUE)
die2 <- sample(x = 1:6, size = 10000, replace = TRUE)
sumDice <- die1 + die2
head(sumDice)
barplot(table(sumDice))
```

b. You can buy trick dice, which look (sort of) like normal dice. One die has numbers 5, 5, 5, 5, 5, 5. The other has numbers 2, 2, 2, 6, 6, 6. Simulate rolling the two trick dice and adding their values. Perform 10000 simulations and make a bar chart showing how many of each outcome occurred.
```{r}
die1 <- sample(c(5,5,5,5,5,5), size = 10000, replace = TRUE)
die2 <- sample(c(2,2,2,6,6,6), size = 10000, replace = TRUE)
sumDice <- die1 + die2
head(sumDice)
barplot(table(sumDice))
```

c. Sicherman dice also look like normal dice, but have unusual numbers. One die has numbers 1, 2, 2, 3, 3, 4. The other has numbers 1, 3, 4, 5, 6, 8. Simulate rolling the two Sicherman dice and adding their values. Perform 10000 simulations and make a bar chart showing how many of each outcome occurred. How does your answer compare to part a?


```{r}
die1 <- sample(c(1,3,4,5,6,8), size = 10000, replace = TRUE)
die2 <- sample(c(1,2,2,3,3,4), size = 10000, replace = TRUE)
sumDice <- die1 + die2
head(sumDice)
barplot(table(sumDice))
```

### Exercise 2.20

Two dice are rolled.

What is the probability that the sum of the numbers is exactly 10?

Sample Space is 36 possible outcomes.

Sum == 10 only when -> (5,5),(6,4)(4,6) = 3/36 = 1/12

```{r}


eventA <- replicate(10000, {
  dieRoll <- sample(1:6, 2, replace = TRUE)
  (sum(dieRoll) == 10)
})
probA <- mean(eventA)
probA

```

What is the probability that the sum of the numbers is at least 10?

Sum >= 10 -> (5,5),(6,4),(4,6),(6,6)(5,6)(6,5) = 6/36 = 1/6

```{r}


eventB <- replicate(10000, {
  dieRoll <- sample(1:6, 2, replace = TRUE)
  (sum(dieRoll) >= 10)
})
probB <- mean(eventB)
probB

```

What is the probability that the sum of the numbers is exactly 10, given that it is at least 10?

P(x>=0 given that x == 10) = P(x == 10)/P(x>=0) = (3/36)/(6/36) = 1/2

```{r}


probC <- probA/probB
probC


```

### Exercise 2.21

A hat contains six slips of paper with the numbers 1 through 6 written on them. Two slips of paper are drawn from the hat (without replacing), and the sum of the numbers is computed.


a. What is the probability that the sum of the numbers is exactly 10?

Sample space reduces to 30 since we cannot have (n,n) and n = 6, which out of 36 possible outcomes reduce to 30.

Sum == 10 -> (4,6)(6,4) = 2/30 = 1/15

```{r}
eventD <- replicate(10000, {
  slip <- sample(1:6, 2, replace = FALSE)
  (sum(slip) == 10)
})
probD <- mean(eventD)
probD
```

b. What is the probability that the sum of the numbers is at least 10?

Sum >= 10 -> (6,4),(4,6),(6,5)(5,6) = 4/30 = 2/15

```{r}
eventE <- replicate(10000, {
  slip <- sample(1:6, 2, replace = FALSE)
  (sum(slip) >= 10)
})
probE <- mean(eventE)
probE

```

c. What is the probability that the sum of the numbers is exactly 10, given that it is at least 10?

P(x>=0 given that x == 10) = P(x == 10)/P(x>=0) = (1/15)/(2/30) = 1/2

```{r}
probF <- probD/probE
probF
```

### Exercise 2.25
In an experiment where you toss a fair coin twice, define events:

Sample Space {HH, HT, TH, TT} = 4 total possible outcomes

.A : the first toss is heads.

H only when HH,HT.= 2/4 = 1/2 = Probability that first toss is Heads

.B : the second toss is heads.

HH,TH = 2/4 = 1/2 = Probability that second toss is heads.

.C : both tosses are the same.

HH,TT = Probability  that all both tosses are same is 2/4 = 1/2.

Show that  
A and   B  are independent. Show that A and C are independent. Show that  B and C are independent. Finally, show that A,B, and  C are not mutually independent.



P(A intersect B) = only when A & B are HH so = 1/4
P(A intersect B) = P(A) * P(B) = 1/2* 1/2 = 1/4

A & B are independent

P(A intersect C) = again only when outcome is HH = 1/4
P(A intersect C) = P(A) * P(C) = 1/2* 1/2 = 1/4

A & C are independent

P(B intersect C) = again only when outcome is HH = 1/4


P(B intersect C) = P(B) * P(C) = 1/2* 1/2 = 1/4

B & C are independent

Mutual independence is when P(A intersects B) = P(A) * P (B)
for all three scenarios the probability is the same which makes all three cases mutually independent as well.

### Exercise 2.30

Suppose there is a new test that detects whether people have a disease. If a person has the disease, then the test correctly identifies that person as being sick 99.9 percent of the time (the sensitivity of the test). If a person does not have the disease, then the test correctly identifies the person as being well 97 percent of the time (the specificity of the test). Suppose that 2 percent of the population has the disease. Find the probability that a randomly selected person has the disease given that they test positive for the disease.

Person with disease = A (Sick)
Person w/o disease = A!

Person that has a positive test is B
Preson that has a negative test is B!

P(A|B) = 0.999
P(A!|B!) = 0.97

P(B) = 0.02
P(B!) = 1 - P(B) = 1 - 0.02 = 0.98

P(A|B!) = 1- P(A!|B!) = 1- 0.97 = 0.03 Probability of person not being well


Probability of a person heaving a disease
P(A) = P(A|B)* P(B)+ P(A|B!) * P(B!)
     = (0.999 * 0.02) + (0.03 * 0.98)
     = 0.04938

Probability of person testing positive given that he has a disease
using Bayes Rule

P(B|A) =  P (A|B)* P(A)/P(A) = (0.999*0.02)/0.04938 = 0.4046 = 40.46%

The chance that a person has the diseased given that they test positive is around 40.46%


### Run other code

#### bayes.R


```{r}
### Conditional Probability Simulation
### Bayesian Probability

# lie detector

prev <- 0.50	# prevalence = P(L)
sens <- 0.80	# sensitivity = P(+|L)
spec <- 0.90		# specificity = 1 - P(+|L^c)

reps <- 10000

true.pos.test.pos <- 0	# counter for lie detector catching a truly lying person
test.pos <- 0		# counter for lie detector says person is lying

for(i in 1:reps){
	# simulate a person as lying or not
	lie <- 0
	if(runif(1) < prev){
		lie <- 1
	}
	# if lying simulate if test positive or not
	if(lie == 1 ){
		if(runif(1) <= sens){
			test.pos <- test.pos + 1
			true.pos.test.pos <- true.pos.test.pos + 1
		}
	}
	# if not lying simulate if test positive or not
	else{
		if(runif(1) <= (1-spec)) test.pos <- test.pos + 1
	}
}

# simulated probability

true.pos.test.pos/test.pos
```
